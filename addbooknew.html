

<html>
<head>
    <meta name="viewport" content="width=device-width, maximum-scale=1 , initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins&effect=neon|outline|emboss|shadow-multiple">
    <title>IBRA</title>
    <script src="index.js" defer></script>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#317EFB" />
    <link rel="apple-touch-icon" href="images/ibra512.png">
    <style>
h1 {text-align:center}

.spinner {  margin: auto;  width: 25px;  border: 3px solid white;  padding: 10px;  background:red;  height:25px;  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);  border-radius: 50%;animation-name: example;animation-duration: 5s;animation-iteration-count: infinite;}
@keyframes example {  0%   {background-color:red;}  25%  {background-color:yellow;}  50%  {background-color:blue;}  75%  {background-color:green;}  100% {background-color:red;}}
body {overscroll-behavior: contain; }
.pname {font-family: "Poppins", sans-serif;text-shadow: 3px 3px 3px #ababab;font-size:25px;}
element.style {display: block;margin-left: 5px;margin-right: 5px;}
a {text-decoration:none}
body {background: powderblue;;margin: 0px auto;width:100%;box-sizing: border-box;}
.active, .btn:hover {background-color: red;color: white;}
#regionTable td:hover { color: red;}
ul {list-style-type: none;margin: 0;padding: 0;overflow: hidden;background-color: #333;     display: flex; justify-content:center;
}
li {font-size:small;        }
.list {display: block;color: white;text-align: center;padding: 2px 6px;text-decoration: none;}
table {border-collapse: collapse;;width: 100%;margin-left: 1px;margin-right: 1px;border: 1px soild black; }
#myInput {width: 300px;;margin-left:30px;height: 30px;border-radius: 15px;background-color: cyan;border: 0px;outline: 0;display: none; margin: auto;  display: block;}
.badge {display: inline-block;padding: 0;width: 25px;height: 25px;line-height: 25px;font-size: x-small;font-weight: lighter !important;color: #fff !important;text-align: center;white-space: nowrap;vertical-align: baseline;background-color: #d73d33;border-radius: 50px;top: -3px;}
.badge1 {display: inline-block;padding: 0;width: 25px;height: 25px;line-height: 25px;font-size: small;font-weight: lighter !important;color: black !important;text-align: center;white-space: nowrap;vertical-align: baseline;background-color: yellow;border-radius: 50px;top: -3px;}
.eabbadge {display: inline-block;padding: 0;width: 25px;height: 25px;line-height: 25px;font-size: small;font-weight: lighter !important;color: black !important;text-align: center;white-space: nowrap;vertical-align: baseline;background-color: pink;border-radius: 50px;top: -3px;}
.smallbadge {display: inline-block;padding: 0;width: 10px;height: 10px;line-height: 10px;font-size: small;font-weight: lighter !important;color: green !important;text-align: center;white-space: nowrap;vertical-align: baseline;background-color: yellow;border-radius: 50px;top: -3px;}
.smalleabbadge {display: inline-block;padding: 0;width: 10px;height: 10px;line-height: 10px;font-size: small;font-weight: lighter !important;color: green !important;text-align: center;white-space: nowrap;vertical-align: baseline;background-color: pink;border-radius: 50px;top: -3px;}
.ibeab {background: pink;}
button a {color:black; }
button {background:yellow; border:0; width:170px; padding:5px; border-radius:15px; box-shadow: 3px 5px #888888; margin-left:5px}
img {border-radius:50px}
#whatsapp { float:right; margin:1px; margin-top:-230px;}
#page1 {display:none;}




      .modal {
            display: none; 
            position: fixed;
            z-index: 1; 
            margin: 0 auto;
            top: 0;
            width: 100%; 
            height: 100%; 
            background-color: rgba(0, 0, 0, 0.5); 
        }

        .modal-content {
            position: relative;
            background-color: #fff;
            margin: 10% auto;
            padding: 00px;
            width: 95%; 
            border-radius: 10px; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); 
        }

        .modal-header {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: #bd179b; 
            color: white;
            border-radius: 10px 10px 0 0; 
        }

        .profile-img {
            width: 80px;
            height: 80px;
            border-radius: 50%; 
            margin-right: 15px;
        }

        .name {
            font-size: 1.5em;
            font-weight: bold;
        }
       
        p {margin:10px; font-family:monospace}


.tableheader {text-align:center}

  
.a {float: left; position: fixed;    top: 34px;    right: 10px;    width: 38px;    height: 38px;
    background: red;    border-radius: 50%;    font-size: xx-large;    color: white;  text-align: center;
}
#wlf {display:none;}
 .responsive-iframe {position: absolute;top: 70px;left: 0;width: 100%;height: 100%;border: none;}
.c {border-radius:15px;   height:40px; width:45vw;  padding-top:15px; text-align:center; color:white; font-size:large; line-height:20px;}
.adbk {background:red;float:left;}
.welf {background:blue;  float:right;  }
#wlf {display:none;}
</style>
</head>

<body>

<div id='wlf'>
<div class='a' onclick=' hideWelfare() '>A</div>

<iframe src="https://gvssmark.github.io/ibra/welfare.html" class="responsive-iframe"  ></iframe>
</div>

<div id='spin'><h1>IBRA ADDRESS BOOK <br>Loading ...</h1>
<div  class="spinner"></div>
</div>
  <div id='page1' >      
  <h3 align=center>Indian Bank Retirees' Association</h3>
        <h4 align=center>Members Address Book</h4>
        <table border=1>
            <tr>
                <td>Region
                <td>State / Districts
            <tr>
                <td>VSP
                <td>Srikakulam, Vizianagaram and Visakhapatnam
            <tr>
                <td>GOD
                <td>East and West Godavaris
            <tr>
                <td>VIJ
                <td>Krishna, Guntur and Prakasam
            <tr>
                <td>SEEMA
                <td>Entire Rayalaseema Area and Nellore
            <tr>
                <td>HYD
                <td>All Districts of Telangana State
            <tr>
                <td>OTH
                <td>All States other than AP & TS
            <tr>
                <td>eAB
                <td>List Earstwhile Allahabad Bank Retiress. These members are grouped in respsective regions
        </table>
        <span class='smallbadge'>&nbsp;</span> &nbsp;indicates a Family Pensioner<br>
        <span class='smalleabbadge'>&nbsp;</span> &nbsp;indicates an eAB Retiree<br><br>
        Members are requested to verify the correctness of their address and suggest changes if any.<br><br>
		
<div >
<div class='adbk c' onclick='shregions()'>Show Address Book</div>
<div class='welf c' onclick='showhideWelfare()'>Welfare Measures</div>
</div>
        </div>

  
  <div id="regions" style="display:none; ">
        <div style="background:#e6b0da; top:0; ; height:83px; overflow:auto; position:fixed; text-align:center;  width: 100%; margin:auto  ">
            <ul>
                <li onclick="selectedRegion(allmemb,0)" class="list active">All</li>
                <li onclick="selectedRegion(vsp,1)" class="list">VSP</li>
                <li onclick="selectedRegion(god,2)" class="list">GOD</li>
                <li onclick="selectedRegion(vij,3)" class="list">VIJ</li>
                <li onclick="selectedRegion(seema,4)" class="list">SEEMA</li>
                <li onclick="selectedRegion(hyd,5)" class="list">HYD</li>
                <li onclick="selectedRegion(oth,6)" class="list">OTH</li>
                <li onclick="selectedRegion(eab,7)" class="list">eAB</li>
                <li onclick="selectedRegion(allMembNoWise,8)" class="list">SR No</li>
            </ul>
            <h4 id='regionHeading' align=center style="margin-top:3px;margin-top: 0px;margin-bottom: 0px;"></h4>
            <input type="text" id='myInput' placeholder="Search here..." onkeyup="fiterName()">
			<div onclick='showhideWelfare()' class='a'>W</div>
        </div>
        <p id='paraInThisRegion' style="margin-top:85px; margin-left:1px; width:100%;"></p>
		
		<div id="myModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
       <img id='photo' class='profile-img '>
        <span id='nameHeader' class="name">Markandeyulu</span>
        <span class="close"></span>
    </div>
    <div class="modal-body">
        <p id='modalData'>This is the modal content. You can add any additional text or elements here.</p>
		<div id='whatsapp'></div>
    </div>
	
  </div>
  
</div>
		
    
    
        <script>
		
		embeded = document.getElementById('wlf')
function showhideWelfare() {
embeded.style.display='block'
document.getElementById('regions').style.display='none'
document.getElementById('page1').style.display='none'

}

function hideWelfare(){document.getElementById("regions").style.display = "block"
embeded.style.display='none'
}
		
		
function ddmmyy(input) {
    const date = new Date(input);
    return isNaN(date.getTime()) ? 'Not Available' : date.toLocaleString("en-GB", { timeZone: "Asia/Kolkata" }).substring(0,10);
  }
  photidurl='https://script.google.com/macros/s/AKfycbw_h5LMGCyIraesAhh6xlkeP8RUz3HO4ga4Q8XZaJhJRpnuQqp3TWUUZyodZPxpeA7A/exec'
        url='https://script.google.com/macros/s/AKfycbwIVAlRrCTt6z_Ej4W6PHhopFqCq1JvEsSoN2RPqgWY7VXLW0P2pteA1jgVFaWePc2S/exec'
            async function getMyData() {
                response = await fetch(url)
 tdata = await response.json()
 data = tdata.map(([id,name,add1,add2,add3,district,place,pincode,fixed,mobile1,mobile2,state,email,srno,sbac,doj,dor,spouse,area,blank,dob,fampen,pensionbr,scanned])=>
({id,name,add1,add2,add3,district,place,pincode,fixed,mobile1,mobile2,state,email,srno,sbac,doj:ddmmyy(doj),dor:ddmmyy(dor),spouse,area,blank,dob:ddmmyy(dob),fampen,pensionbr,scanned}))
activeMembers =data.filter(a => a.name !== "").sort(function (a, b) { return a.name.localeCompare(b.name) });
//console.log(activeMembers)

				photoresponse = await fetch(photidurl)
				pdata = await photoresponse.json()
				photodata= pdata.map(([mno,photoid]) => ({mno,photoid}))
				photodata.shift()					
	photodata.length >0 ? (document.getElementById('spin').style.display='none', document.getElementById('page1').style.display='block' ):''							
activeMembers.forEach(function (element) { element.IBorEAB = (element.area.substr(-3).toUpperCase() === 'EAB' ? "EAB" : "IB"), element.pentype = (element.fampen.length > 0 ? "fam" : "ser") })
familyPensioners = activeMembers.filter(a => a.fampen !== "").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB }));
vsp = activeMembers.filter(a => a.area.substr(0, 3) === "VSP").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno, mobile: a.mobile1 }));
vij = activeMembers.filter(a => a.area.substr(0, 3) === "VIJ").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno, mobile: a.mobile1  }));
god = activeMembers.filter(a => a.area.substr(0, 3) === "GOD").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno, mobile: a.mobile1  }));
seema = activeMembers.filter(a => a.area.substr(0, 5) === "SEEMA").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno , mobile: a.mobile1 }));
hyd = activeMembers.filter(a => a.area.substr(0, 3) === "HYD").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno , mobile: a.mobile1 }));
oth = activeMembers.filter(a => a.area.substr(0, 3) === "OTH").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno, mobile: a.mobile1  }));
eab = activeMembers.filter(a => a.area.substr(-3).toUpperCase() === "EAB").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno , mobile: a.mobile1 }));
blank = activeMembers.filter(a => a.area === "BLANK").map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno, mobile: a.mobile1  }));
allMembNoWise = activeMembers.map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno, mobile: a.mobile1  })).sort(function (a, b) { return a.srno - b.srno })
allmemb = activeMembers.map(a => ({ id: a.id, name: a.name, fampen: a.fampen, ibeab: a.IBorEAB, srno: a.srno, mobile: a.mobile1  }));
selectedRegion(allmemb,0)
//if(activeMembers.length>0){document.getElementById("addbtn").style.display = "block"}
}

penbrTemp = ""


getMyData()
function shregions(){
document.getElementById("regions").style.display = "block"
document.getElementById("page1").style.display = "none"
}

function selectedRegion(array, n) {
document.getElementById("myInput").value = "";
document.getElementById("myInput").style.display = "block"
document.documentElement.scrollTop = 0;
famPensionersCount = array.filter(a => a.fampen.length > 0).length
eabcount = array.filter(a => a.ibeab === 'EAB').length
regions = ["All Members", "Visakhapatnam Area", "Godavari Area", "Vijayawada Area", "Seema Area", "Hyderabad Area", "Other States", "e Allahabad", "SR No Sorted"]
document.getElementById('regionHeading').innerHTML = "Memebers in " + regions[n] + " <span class='badge'>" + array.length + "</span><span class='badge1'>" + famPensionersCount + "</span> <span class='eabbadge'>" + eabcount + "</span>"
inThisRegion = "<table id='regionTable'  border=1><tr class='tableheader'><td>Name / Mobile / SR No / Memb No /Photo "
array.forEach(function (a) { inThisRegion += "<tr align=center onClick='nameclick(this.id)' id=" + a.id + "><td class='" + (a.fampen.length > 0 ? "fam" : "ser") + "'>" +"<span class='pname'>"+ a.name +"</span>"+ (a.fampen.length > 0 ? " <span class='smallbadge'> &nbsp;</span><br>Family Pension of:  " + a.fampen : " ") + (a.ibeab === 'EAB' ? "<span class='smalleabbadge'>&nbsp;" : "") + "</span> <br> Mobile: " +a.mobile +" / SR: " + a.srno +" / Memb: " +a.id+" / Photo: " +isPhoto(a.id)+ "</td></tr>" })
                inThisRegion += "</table><br><br><br>"
                document.getElementById('paraInThisRegion').innerHTML = ""
                document.getElementById('paraInThisRegion').innerHTML = inThisRegion
                window.scrollTo(0, 0);
            }

            isInsured = (srno) => insdata.filter(a => a.SRNO === srno).length;
			isPhoto = (srno) => photodata.filter(a=> a.mno === srno.toString()).length >0 ? 'Yes' : 'No'
            myVar = ""
            var modal = document.getElementById("myModal");
            var span = document.getElementsByClassName("close")[0];
            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
      window.addEventListener('touchstart', function (event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
});

      window.addEventListener('touchend', function (event) {
    if (event.target == modal) {
        modal.style.display = "none";
    }
});
		
           // modal.addEventListener("touchstart",hmodal)

function hmodal(){modal.style.display = "none"}

            span.onclick = function () {
                modal.style.display = "none";
            }
            function nameclick(membershipNo) {
                toDisplay = "<table ><tr>"
                document.getElementById("myInput").value = ""
                membno = membershipNo * 1 - 1;
                memphotoid = photodata.filter(a=> a.mno  ===  membershipNo)
                memphoto = memphotoid.length>0 ? `https://drive.google.com/thumbnail?id=${memphotoid[0].photoid} `  : "https://drive.google.com/thumbnail?id=1R_n_BkLD7kHOVJ-l4qqgAT0PTiSq_OtM"
                membData = activeMembers.filter(a => a.id === membershipNo * 1)
                toDisplay += "<tr><td colspan=2><b>Membership No</b> " + membData[0].id
                toDisplay += "<tr><td colspan='2'><b>Address: </b><br>" + membData[0].add1 + "<br>"
                if (membData[0].add2.length > 0) { toDisplay += membData[0].add2 + "<br>" }
                if (membData[0].add3.length > 0) { toDisplay += membData[0].add3 + "<br>" }
                if (membData[0].place.length > 0) { toDisplay += membData[0].place + "  " + membData[0].pincode + "<br>" }
                if (membData[0].district.length > 0) { toDisplay += membData[0].district + " District <br>" }
                toDisplay += "<tr><td colspan=2><b>Phones: </b>"
                if (membData[0].fixed.length > 0) { toDisplay += membData[0].fixed + " / " }
                if (membData[0].mobile1 > 0) { toDisplay += "<a href=tel:" + membData[0].mobile1 + "><mark style='background:red; color:white'>" + membData[0].mobile1 + "</mark></a>" }
                if (membData[0].mobile2 > 0) { toDisplay += " / " + membData[0].mobile2 }
                toDisplay += "<tr><td colspan=2><b>Email: </b>" + membData[0].email
                toDisplay += "<tr><td colspan=2><b>S R No: </b>" + membData[0].srno
                toDisplay += "<tr><td colspan=2><b>DOB: </b>" + membData[0].dob
                toDisplay += "<tr><td colspan=2><b>DOJ: </b>" + membData[0].doj
                toDisplay += "<tr><td colspan=2><b>DOR: </b>" + membData[0].dor
                toDisplay += "<tr><td colspan=2><b>Spouse Name: </b>" + membData[0].spouse
                
                toDisplay += "<tr><td colspan=2><b>Application Scanned:</b>" + membData[0].scanned
                toDisplay += "<tr><td colspan=2><b>Pension Br:</b>" + membData[0].pensionbr
                if (membData[0].fampen != "") {
                    toDisplay += "<tr bgcolor=yellow><td colspan=2><b>Family Pension of :</b>" + membData[0].fampen
                }
                toDisplay += "<tr><td colspan=2><b>Pension Acc: </b> " + membData[0].sbac
                whichBank = membData[0].IBorEAB === 'IB' ? "Indian Bank" : "e Allahabad Bank"
                toDisplay += "<tr><td colspan=2><b>Retired from : </b> " + whichBank
                toDisplay += "<tr><td colspan=2><b>Region : </b> " + membData[0].area.substr(0, 3)
                document.getElementById("modalData").innerHTML = toDisplay + "<table>"
                document.getElementById("nameHeader").innerHTML = membData[0].name
                modal.style.display = "block";
                document.getElementById('photo').src = memphoto
				if (isMobileDevice) {document.getElementById('whatsapp').innerHTML =`<a aria-label="Chat on WhatsApp" href="https://wa.me/91${membData[0].mobile1}"> <img alt="Chat on WhatsApp" src="images/WhatsApp.jpg" height=50px /><a />`}
               // document.getElementById('whatsapp').innerHTML =`<a aria-label="Chat on WhatsApp" href="https://wa.me/91${membData[0].mobile1}"> <img alt="Chat on WhatsApp" src="images/WhatsApp.jpg" height=50px /><a />`
            }

            function fiterName() {
                var input, filter, table, tr, td, i, txtValue;
                input = document.getElementById("myInput");
                filter = input.value.toUpperCase().replaceAll(" ","");
                table = document.getElementById("regionTable");
                tr = table.getElementsByTagName("tr");
                for (i = 0; i < tr.length; i++) {
                    td = tr[i].getElementsByTagName("td")[0];
                    if (td) {
                        txtValue = td.textContent || td.innerText;
                        if (txtValue.toUpperCase().replaceAll(" ","").indexOf(filter) > -1) {
                            tr[i].style.display = "";
                        } else {
                            tr[i].style.display = "none";
                        }
                    }
                }
            }
            var btnContainer = document.getElementById("regions");
            var btns = btnContainer.getElementsByClassName("list");
            for (var i = 0; i < btns.length; i++) {
                btns[i].addEventListener("click", function () {
                    var current = document.getElementsByClassName("active");
                    current[0].className = current[0].className.replace(" active", "");
                    this.className += " active";
                });
            }
let details = navigator.userAgent;
let regexp = /android|iphone|kindle|ipad/i;
let isMobileDevice = regexp.test(details);

        </script>
</body>
</html>
