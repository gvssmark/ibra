





<!DOCTYPE html>
<html>
<head>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Page Title</title>
<style>
  table {
            /* Not required only for visualizing */
            border-collapse: collapse;
            ;
            width: 95%;
            margin-left: 5px;
            margin-right: 1px;
            border: 1px soild black;
            
        }
        .insurancebadge{
  display: inline-block;
   padding: 0;
    width: 10px;
    height: 10px;    
    line-height: 10px;
    font-size: small;
    font-weight: lighter !important;
    color: green !important;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    background-color: green;
    border-radius:50px;
//    position: relative;
    top: -3px;
    }
ul {  list-style-type: none;  margin: 0;  padding: 0;  overflow: hidden;  background-color: #333;}
li {  float: left;}
.list{  display: block;  color: white;  text-align: center;  padding: 8px 10px;  text-decoration: none;}
</style>


</head>
<body>
<div id="regions" style="background:powderblue; top:0; ; height:40px; overflow:auto; position:fixed; width: 100%; ">
<ul>
  <li onclick="alltab()"  class="list active" >Non IB/eAB</li>
  <li  onclick="selectBank(ib)" class="list" >IB</li>
  <li  onclick="selectBank(eab)" class="list" >e AB</li>
  <li  onclick="albk()" class="list" >Summary</li>  
</ul>
</div>
<h3>IBRA Insurance Data</h3>

<p id='insmemb'>This is a paragraph.</p>
<script>

 url = 'https://script.google.com/macros/s/AKfycbzI9SDFOzYLYKRKJTlse0XpsEiF8XfbyxwUUH22evlGkEPDIt2V/exec'
        async function getMyData() {
            response = await fetch(url)
            data = await response.json()
            tempData = data["user"]
            activeMembers = tempData.filter(a => a.name !== "")
                .sort(function (a, b) { return a.name.localeCompare(b.name) });
                addkey()
            
               }
                
                getMyData()
               
                 function addkey(){
for (i=0; i<insdata.length; i++){
insuredSRNO = insdata[i].SRNO
xx= activeMembers.filter( a => a.srno === insuredSRNO)
mstatus= xx.length>0 ?     "Member" : "not member"
insdata[i].member= mstatus
}
}



                </script>
                 <script src="https://drive.google.com/uc?id=1EeiSTfOD-0UA4hz1bwKwW2T7KM1XnndG"></script>
  
<script>
insdata.sort(function (a, b) { return a.Name.localeCompare(b.Name) }).sort(function (a, b) { return a.Bank.localeCompare(b.Bank) });
 ib=insdata.filter(a => a.Bank ==="Indian Bank")
 eab=insdata.filter(a => a.Bank ==="e-Allhabad Bank")
 oth=insdata.filter(a => (a.Bank !=="Indian Bank" && a.Bank  !== "e-Allhabad Bank"))

 
 
function selectBank(bankArray){ 

console.table(bankArray) 
inThisRegion="<table id='regionTable'  border=1>"
bankArray.forEach(function (a) { inThisRegion += "<tr ><td>" + a.SRNO + "<td>" + a.Name + (a.member === "Member" ? "&nbsp<span class='insurancebadge'>0</span>": "")
  })
 inThisRegion +="</table><br><br><br>"
document.getElementById('insmemb').innerHTML=inThisRegion
}
allbanks = unq(oth.filter(a => a.Bank !== "").map(a =>a.Bank))

function alltab(){
alldata="<table border=1>"
for (i=0; i<allbanks.length; i++){
tempbank = oth.filter(a => a.Bank === allbanks[i])
alldata += "<tr><td align=center colspan=2 bgcolor=cyan>"+allbanks[i]+"--"+tempbank.length
tempbank.forEach(function (a) { alldata +="<tr><td>"+a.SRNO+ "<td>" + a.Name
});
document.getElementById('insmemb').innerHTML=alldata +"</table>"
}}

function unq(a) { return Array.from(new Set(a)); }
//albk()

function albk(){
tboi = insdata.filter (a => a.Bank ==="Bank Of India")
tcan = insdata.filter (a => a.Bank ==="Canara Bank")
tand = insdata.filter (a => a.Bank ==="e Andhra Bank")
tsyn = insdata.filter (a => a.Bank ==="e Syndicate Bank")
teab = insdata.filter (a => a.Bank ==="e-Allhabad Bank")
ticic = insdata.filter (a => a.Bank ==="ICICI BANK")
tib = insdata.filter (a => a.Bank ==="Indian Bank");
tiob = insdata.filter (a => a.Bank ==="Indian Overseas Bank")
tpnb = insdata.filter (a => a.Bank ==="Punjab National Bank")
tsbi = insdata.filter (a => a.Bank ==="State Bank of India")
tuco = insdata.filter (a => a.Bank ==="UCO BANK")
tubi = insdata.filter (a => a.Bank ==="Union Bank of India")



mboi= tboi.filter (a=> a.member ==="Member").length
mcan= tcan.filter (a=> a.member ==="Member").length
mand= tand.filter (a=> a.member ==="Member").length
msyn= tsyn.filter (a=> a.member ==="Member").length
meab= teab.filter (a=> a.member ==="Member").length
micic= ticic.filter (a=> a.member ==="Member").length
mib= tib.filter (a=> a.member ==="Member").length
miob= tiob.filter (a=> a.member ==="Member").length
mpnb= tpnb.filter (a=> a.member ==="Member").length
msbi= tsbi.filter (a=> a.member ==="Member").length
muco= tuco.filter (a=> a.member ==="Member").length
mubi= tubi.filter (a=> a.member ==="Member").length



stable ="<table border=1>"
stable += "<tr><td>Bank<td>Insured<td>Memb<td>Non Memb"
nb = tib.length -mib
stable += "<tr><td>Indian Bank<td>"+tib.length +"<td>" + mib+"<td>" + nb
nb = teab.length -meab
stable += "<tr><td>e-Allhabad Bank<td>"+teab.length +"<td>" + meab+"<td>" + nb
nb=tboi.length-mboi
stable += "<tr><td>Bank Of India<td>"+tboi.length +"<td>" + mboi +"<td>" + nb
nb = tcan.length - mcan
stable += "<tr><td>Canara Bank<td>"+tcan.length +"<td>" + mcan +"<td>" + nb
nb = tand.length -mand
stable += "<tr><td>e Andhra Bank<td>"+tand.length +"<td>" + mand+"<td>" + nb
nb = tsyn.length -msyn
stable += "<tr><td>e Syndicate Bank<td>"+tsyn.length +"<td>" + msyn+"<td>" + nb

nb = ticic.length -micic
stable += "<tr><td>ICICI BANK<td>"+ticic.length +"<td>" + micic+"<td>" + nb

nb = tiob.length -miob
stable += "<tr><td>Indian Overseas Bank<td>"+tiob.length +"<td>" + miob+"<td>" + nb
nb = tpnb.length -mpnb
stable += "<tr><td>Punjab National Bank<td>"+tpnb.length +"<td>" + mpnb+"<td>" + nb
nb = tsbi.length -msbi
stable += "<tr><td>State Bank of India<td>"+tsbi.length +"<td>" + msbi+"<td>" + nb
nb = tuco.length -muco
stable += "<tr><td>UCO BANK<td>"+tuco.length +"<td>" + muco+"<td>" + nb
nb = tubi.length -mubi
stable += "<tr><td>Union Bank of India<td>"+tubi.length +"<td>" + mubi+"<td>" + nb
stable += "</table>"

document.getElementById('insmemb').innerHTML=stable
}












</script>
</body>
</html>














