

<!DOCTYPE html>
<html>
<head>
      <meta name="theme-color" content="#317EFB" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Insurance 2021-22</title>
<script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=_DoJYplHO-6tlZ-Iy9EqaVMACj6e2e-w0yxjidMSCo-1mmHoLOZxtxQpVv_BejTcxvTr8MXPKiVKkXmHjkzkfQ" charset="UTF-8"></script><style>
      .active, .btn:hover {
  background-color: red;
  color: white;
}
body{margin:0px; background:LavenderBlush}
  table {
            /* Not required only for visualizing */
            border-collapse: collapse;
            ;
            width: 95%;
            margin-left: 5px;
            margin-right: 1px;
            border: 1px soild black;
        }
        .insurancebadge{
  display: inline-block;
   padding: 0;
    width: 10px;
    height: 10px;    
    line-height: 10px;
    font-size: small;
    font-weight: lighter !important;
    color: green !important;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    background-color: green;
    border-radius:50px;
//    position: relative;
    top: -3px;
    }
ul {  list-style-type: none;  margin: 0;  padding: 0;  overflow: hidden;  background-color: #333;}
li {  float: left;}
.list{  display: block;  color: white;  text-align: center;  padding: 8px 10px;  text-decoration: none;}

.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
    
#myInput{
font-family: "Lohit Telugu", Arial, "Droid Serif", "sans-serif" !important;
    margin-top: 5px;
    width: 180px;
    margin-left: 25%;
    height: 30px;
    border-radius: 15px;
    background-color: cyan;
    border: 0px;
    outline: 0;}

html {
    height: 100%;
    margin: 0;
}
body {
    min-height: 100%;
    margin: 0;
}
</style>
</head>
<body>
<div id="regions" style=" top:0; ; height:80px; overflow:auto; position:fixed; width: 100%; ">
<ul>
  <li onclick="alltab()"  class="list active" >Non IB/eAB</li>
  <li  onclick="selectBank(ib)" class="list" >IB</li>
  <li  onclick="selectBank(eab)" class="list" >e AB</li>
  <li  onclick="albk()" class="list" >Summary</li>  
</ul>
<div id='inputbox' style="display : none";>
 <input type="text" id='myInput' placeholder="Search name here..." onkeyup="fiterName()">
</div>
</div>


<p id='insmemb' style="margin-top:39px;">IBRA Insurance 2021-22 Data</p>
 

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div  class="modal-content">
    <span class="close">&times;</span>
    <p id='modalcontent' >Some text in the Modal..</p>
  </div>

</div>



<script>
 url = 'https://script.google.com/macros/s/AKfycbzI9SDFOzYLYKRKJTlse0XpsEiF8XfbyxwUUH22evlGkEPDIt2V/exec'
        async function getMyData() {
            response = await fetch(url)
            data = await response.json()
            tempData = data["user"]
            activeMembers = tempData.filter(a => a.name !== "")
                .sort(function (a, b) { return a.name.localeCompare(b.name) });
                addkey()
               }
                getMyData()
                 function addkey(){
for (i=0; i<insdata.length; i++){
insuredSRNO = insdata[i].SRNO
xx= activeMembers.filter( a => a.srno === insuredSRNO)
mstatus= xx.length>0 ?     "Member" : "not member"
insdata[i].member= mstatus
      
      xx.length>0 ? insdata[i].MemNo= xx[0].id : insdata[i].MemNo=0
}
}
                </script>
  
<script src="https://gvssmark.github.io/ibra/insdata.js"></script>

    <script src="999insdata.js"></script>
    <script src="https://drive.google.com/uc?id=1EeiSTfOD-0UA4hz1bwKwW2T7KM1XnndGx"></script>  
<script>
insdata.sort(function (a, b) { return a.Name.localeCompare(b.Name) })
 ib=insdata.filter(a => a.Bank ==="Indian Bank")
//ib = ib.sort(function (a,b) {return a.MemNo*1 - b.MemNo*1})
//ibx=iib.sort((a, b)=> {return a.MemNo - b.MemNo})

eab=insdata.filter(a => a.Bank ==="e-Allhabad Bank")
 oth=insdata.filter(a => (a.Bank !=="Indian Bank" && a.Bank  !== "e-Allhabad Bank"))

function selectBank(bankArray){ 
      document.getElementById("myInput").value=""
 document.documentElement.scrollTop = 0;
document.getElementById("inputbox").style.display = "block";
inThisRegion="<br><br><br><table id='regionTable'  border=1><tr><td>SRNO<td>Name<TD>MNo"

nm=bankArray.filter(a=> a.MemNo>0)

mm=bankArray.filter(a=> a.MemNo===0)
inThisRegion +="<tr bgcolor=red><td align=center colspan=3>Non Members - " + mm.length

mm.forEach(function (a) { inThisRegion += "<tr id='"+a.SRNO+"' onclick='showSrno(this.id)' ><td>" + a.SRNO + "<td>" + a.Name + (a.member === "Member" ? "&nbsp<span class='insurancebadge'>0</span>": "")+"<td>"+a.MemNo

  })

inThisRegion +="<tr bgcolor=yellow><td align=center colspan=3>Members - " + nm.length

nm.forEach(function (a) { inThisRegion += "<tr id='"+a.SRNO+"' onclick='showSrno(this.id)' ><td>" + a.SRNO + "<td>" + a.Name + (a.member === "Member" ? "&nbsp<span class='insurancebadge'>0</span>": "")+"<td>"+a.MemNo})


 inThisRegion +="</table><br><br><br>"
document.getElementById('insmemb').innerHTML=inThisRegion
}


allbanks = unq(oth.filter(a => a.Bank !== "").map(a =>a.Bank))

      function alltab(){
      document.getElementById("inputbox").style.display = "none";
            othbanks = unq(oth.filter(a => a.Bank !== "").map(a =>a.Bank))
alldata="<table border=1>"
for (i=0; i<othbanks.length; i++){
tempbank = oth.filter(a => a.Bank === othbanks[i])
alldata += "<tr><td align=center colspan=2 bgcolor=cyan>"+othbanks[i]+"--"+tempbank.length
tempbank.forEach(function (a) { alldata +="<tr><td>"+a.SRNO+ "<td>" + a.Name
});
document.getElementById('insmemb').innerHTML=alldata +"</table>"
}}
function unq(a) { return Array.from(new Set(a)); }
function albk(){
document.getElementById("inputbox").style.display = "none";
banksum = "<table id='dataTable'  border=1><tr><td>Bank<td>Insured<td>Memb<td>Non Memb"
allbanks = unq(insdata.filter(a => a.Bank !== "").map(a =>a.Bank))
for (i=0; i<allbanks.length; i++){
bankcount = insdata.filter (a => a.Bank === allbanks[i])
memcount = bankcount.filter (a=> a.member ==="Member").length
banksum +="<tr><td>" +allbanks[i]+"<td>"+bankcount.length +"<td>" +memcount +"<td>"+ (bankcount.length - memcount)
}
tins = insdata.length
tmem = insdata.filter(a => a.member === "Member").length
banksum += "<tr><td>Total<td>"+ tins +"<td>"+ tmem +"<td>"+(tins - tmem)+"</table>"
document.getElementById('insmemb').innerHTML=banksum
}
      
       var btnContainer = document.getElementById("regions");
   var btns = btnContainer.getElementsByClassName("list");
   for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener("click", function() {
    var current = document.getElementsByClassName("active");
    current[0].className = current[0].className.replace(" active", "");
    this.className += " active";
  });
}

var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 


// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}


function showSrno(srno){
//alert(a)
 
  thisdata = insdata.filter (a  => a.SRNO === srno*1)
      thisdata=thisdata[0]
hi = `  <table border=1>
<tr><td colspan=2 align=center bgcolor='pink'>${thisdata.Name}
<tr><td>Retired from<td>${thisdata.Bank}
<tr><td>SR No<td>${thisdata.SRNO}
<tr><td>Mobile<td>${thisdata.Mobile}
<tr><td>Place<td>${thisdata.Place}
<tr><td>Base Policy<td>${thisdata.Base}
<tr><td>Sup Topup<td>${thisdata.STP}
<tr><td>Single or Family<td>${thisdata.SorF}
<tr><td>Membership No<td>${thisdata.MemNo>0?thisdata.MemNo :"Not a Member"}
      </table> `

  document.getElementById('modalcontent').innerHTML=hi
   modal.style.display = "block";

  
}


function fiterName() {
      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("myInput");
      filter = input.value.toUpperCase();
      table = document.getElementById("regionTable");
      tr = table.getElementsByTagName("tr");
      for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[1];
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }
      }
    }
</script>
</body>
</html>

