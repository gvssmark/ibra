

<!DOCTYPE html>
<html>

<head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins&effect=neon|outline|emboss|shadow-multiple">        
        <style>
.pname {font-family: "Poppins", sans-serif; text-shadow: 3px 3px 3px #ababab;   font-size:18px; }
body{width:360px; margin:auto;}
.modal {display: none;position: fixed;z-index: 10;padding-top: 1px;left: inherit;top: 0;width: 360px;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}
.modal-content {background-color: #ffe7c0;margin: auto;padding: 2px;padding-bottom: 2px;border: 1px solid #888;width: 95%;border-radius: 15px; height:75%; overflow-y: scroll;}
.close {color: #fd0b20;float: right;font-size: 28px;font-weight: bold;}
#modalData{padding:0px;}
table {border-collapse: collapse;width: 100%;margin-left: 1px;margin-right: 1px;border: 1px soild black;font-size: large;}
        
#inddata {display:none; width:360px; nargin-top:50px;     position: fixed; z-index: 1; margin-left:1px; background:powderblue; height:400px; overflow: scroll;}        
h2, h4{text-align:center; }
</style></head>
<body>

<h2>IBRA - INSURANCE 2022-23</h1>
<h4>Data sorted on SR Number</h6>
<h4>Number of Applications: <span id='appno'></span></h6>
<h4>Number of Applications Reconciled: <span id='recno'></span></h6>


<Div id='inddata'>This is test data</div>
<div id='alldata'>


<p id='tdata'></p>

</div>

  <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <p id="modalData"></p>
        </div>
    </div>

<script>
 url = 'https://script.google.com/macros/s/AKfycbzM6Jn5s6SL_BeEU5Q28do25iNl988xOdIrZIrorxwlhzpdgXMajRrSowPenhzLOvyk/exec'
            async function getMyData() {
                response = await fetch(url)
                data = await response.json()
                tempData = data["user"]
                
 tabdata=''               
                
srnos = tempData.filter(a=> a.relation === "1Self").sort(function (a, b) { return a.srno - b.srno }) 

srnos.forEach(function(a) { tabdata += `<tr onclick='rowclick(this.id)' id='${a.srno}'  ><td> SR No ${a.srno}<span style='font-size:small'> ${a.trstatus === "success" ? "Reconciled" : "Not Reconciled"}</span> <br>${a.name}  `})                
document.getElementById('tdata').innerHTML =`<table class='pname' border=1 ><tr><td> SR No  and Name ${tabdata}  </table>`              
document.getElementById('appno').innerHTML = srnos.length                
document.getElementById('recno').innerHTML = tempData.filter(a=> a.trstatus ==="success").length
                
                }
               
  getMyData()              


premiumArray = [
[0,'Not Filled',0,0],
[35913,	"Family",	300000,	0],
[43281,	"Family", 300000,	300000],
[44754,	"Family",	300000,	400000],
[46173,	"Family",	400000,	0],
[53541,	"Family",	400000,	300000],
[55014,	"Family",	400000,	400000],
[58452,	"Family",	400000,	500000],
[27376,	"Self",	300000,	0],
[32326,	"Self",	300000,	300000],
[33316,	"Self",	300000,	400000],
[38940,	"Self",	400000,	0],
[43890,	"Self",	400000,	300000],
[44880,	"Self",	400000,	400000],
[47191,	"Self",	400000,	500000]]

paobject = premiumArray.map(([premium, type, base, supertop]) => ({ premium, type, base, supertop }))



function rowclick(id){
//window.scrollTo(0,0)
//alert(typeof(id))
rowdat = tempData.filter(a=> a.srno === id)
rowdat.length>1 ? (spname = rowdat[1].name, spdob=rowdat[1].dob) : (spname='', spdob='')

pamt = rowdat[0].premuimamt ==="" ? 0 : rowdat[0].premuimamt

ptable =  paobject.filter(a => a.premium === pamt)



x=rowdat[0].name
//alert(x)
//document.getElementById('inddata').style.display='block'
//document.getElementById('inddata').innerHTML=x
x=rowdat[0].name
//alert(x)
//document.getElementById('inddata').style.display='block'
//document.getElementById('inddata').innerHTML=x
inddata =`<table BORDER=1><tr><td>Name<td>${rowdat[0].name}
<tr><td>Premium<td>${rowdat[0].premuimamt}

<tr><td>Policy Type<td>${ptable[0].type}
<tr><td>Base<td>${ptable[0].base}
<tr><td>S Topup<td>${ptable[0].supertop}
<tr><td>SR No<td>${rowdat[0].srno}
<tr><td>Date of Birth<td>${rowdat[0].dob}
<tr><td>Gender<td>${rowdat[0].gender}

<tr><td>Spouse Name<td>${spname}
<tr><td>Spouse DOB<td>${spdob}

<tr><td>Bank Name<td>${rowdat[0].bankname}
<tr><td>Mobile No<td>${rowdat[0].mobile}
<tr><td>Email<td>${rowdat[0].email}
<tr><td>Adhar<td>${rowdat[0].adhar}
<tr><td>PAN<td>${rowdat[0].pan}
<tr><td>Address<td>${rowdat[0].address}
<tr><td>City<td>${rowdat[0].city}
<tr><td>PIN Code<td>${rowdat[0].pin}
<tr><td>Premium Payment Type<td>${rowdat[0].premtype}
<tr><td>Online Payment Mode<td>${rowdat[0].modeofpayment}

<tr><td>Cheque Date/NEFT Date<td>${rowdat[0].chqdate}
<tr><td>Cheque/UTR No<td>${rowdat[0].chqno}
<tr><td>Offline Payment Mode<td>${rowdat[0].offlinemode}
<tr><td>Nominee Name<td>${rowdat[0].nomname}
<tr><td>Nominee Gender<td>${rowdat[0].nomgender}
<tr><td>Nominee DOB<td>${rowdat[0].nomdob}

<tr><td>Nominee Relation<td>${rowdat[0].nomrelation}

<tr><td>Status of Form Registration<td>${rowdat[0].formstatus}
<tr><td>Easebuzz ID<td>${rowdat[0].ezbuzzid}
<tr><td>Matched With<td>${rowdat[0].machedwith}


<tr><td>Transaction Date<td>${rowdat[0].trandate}

<tr><td>Reconciliation Status<td>${rowdat[0].reconstatus}

`
            document.getElementById("myModal").style.display = "block"


document.getElementById("modalData").innerHTML=inddata +"</table>"
                        


}

function clbtn(){
document.getElementById('inddata').innerHTML=''
document.getElementById('inddata').style.display='none'

}

      var modal = document.getElementById("myModal");
        var span = document.getElementsByClassName("close")[0];
        
        span.onclick = function () {
            modal.style.display = "none";
        }
        
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }


</script>

</body>
</html>

