
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IBRA-APTS</title>
 <script src="index.js" defer></script>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#317EFB"/>
<style>
.container
{
width:360px;
//border:1px solid black;
//height:100vh;
 
}
.bottomdiv
{bottom:0px; 
background:green;
position:fixed;
width:360px;

}
table {
  /* Not required only for visualizing */
  border-collapse: collapse; ;  
 width: 95%;
  margin-left: 1px;
  margin-right: 1px;
  
}
button {
  background-color: #4CAF50; /* Green */
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
  width:100px;
  margin-left:130px;
  border-radius:20px;
 box-shadow: 0 8px 8px 0  rgba(0,0,0,0.5);
}
</style>
</head>

<body style="background-color:powderblue; margin-left: 0px;">
<div class="container">
<div style="text-align:center; width:360px; height:50px; position:fixed; background-color: red; top:0px;  color:white;  ">
<h3>Indian Bank Retirees' Association, (AP&TS)</h3>

</div>
<div id="div1">
<input type="text"  id='myInput' onkeyup="dispdata()" style="margin-top:80px; width:50%; margin-left:25%; height:30px; border-radius:15px;  background-color: cyan;  border:0px;  outline:0;" placeholder="Search here...">

<p id='getnames' style="margin-left :1px; scroll:auto;  "></p>
</div>
<div  id="div2" style="width:360px; margin-left:1px; position:center; ; display:none">
<br><br><br><br>
<p id="details" style="margin-left:1px;  "> 





</p>

</div>

<div class="bottomdiv">
<button  onclick='hide()' id='btn1'>Home</button>  
</div>

</div>

<script>

url='https://script.google.com/macros/s/AKfycbzI9SDFOzYLYKRKJTlse0XpsEiF8XfbyxwUUH22evlGkEPDIt2V/exec'
async function getMyData (){
response= await fetch(url)
data= await response.json()
tempData=data["user"]
dispdata()
}

getMyData()

function dispdata(){
let  filter = document.getElementById("myInput").value.toLowerCase()
if (filter.length<=4){document.getElementById("getnames").innerHTML="" }
if (filter.length>=3){
toTable = tempData.filter(a => a.name.toLowerCase().includes(filter.toLowerCase()))
.sort((a, b) => {
    let fa = a.name.toLowerCase(), fb = b.name.toLowerCase();
    if (fa < fb) {return -1;}
    if (fa > fb) {return  1;}
    return 0;
}).map (a => [a.id, a.name]);
tablebody=""
toTable.forEach(function(a){tablebody+= "<span onClick='nameclick(this.id)' id="+ a[0] + ">" +a[1].toUpperCase() + "</span><br>"})
document.getElementById("getnames").innerHTML=tablebody+"<br><br><br>"
}
}

function nameclick(membershipNo){
toDisplay = "<table border=1><tr>"
document.getElementById("div2").style.display = "block";
document.getElementById("div1").style.display = "none";
document.getElementById("myInput").value=""
membno= membershipNo*1-1 ; 
membData= tempData.filter(a => a.id ===membershipNo*1)
toDisplay += "<tr><td>Name<td> " + membData[0].name 
toDisplay += "<tr><td>Mem. No<td>" + membData[0].id 
toDisplay += "<tr><td>Address: <td>" + membData[0].add1 +"<br>"
if(membData[0].add2.length>0){toDisplay += membData[0].add2+"<br>" }
if(membData[0].add3.length>0){toDisplay += membData[0].add3+"<br>" }
if(membData[0].place.length>0){toDisplay += membData[0].place+ "  " +membData[0].pincode + "<br>"   }
if(membData[0].district.length>0){toDisplay += membData[0].district+" District <br>" }
toDisplay += "<tr><td>Phones: <td>"
if(membData[0].fixed.length>0){toDisplay += membData[0].fixed + " / "}
if(membData[0].mobile1>0){toDisplay += membData[0].mobile1 }
if(membData[0].mobile2>0){toDisplay +=   " / "+ membData[0].mobile2}
toDisplay += "<tr><td>SR No<td> " + membData[0].srno 
toDisplay += "<tr><td>Pension Br<td>" +membData[0].pensionbr 
toDisplay += "<tr><td>Pension Acc<td> " +membData[0].sbac.toString().replace(/\b[\dX][-. \dX]+(\d{4})\b/g, '******** $1') + "<br>"
//toDisplay += "<input type=button id='btn1' value='close' onclick='hide()' "
document.getElementById("details").innerHTML=toDisplay+"<table>"
}
function hide(){
document.getElementById("div2").style.display = "none";
document.getElementById("div1").style.display = "block";
document.getElementById("getnames").innerHTML="" 
}

</script>


</body>
</html>
