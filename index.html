


<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="background-color:powderblue; margin-left: 0px;">
<div style="text-align:center; width:100%; height:75px; position:fixed; background-color: yellow; top:0px;    ">
<h3>Indian Bank Retirees' Association, (AP&TS)</h3>
</div>
<div id="div1">
<input type="text"  id='myInput' onkeyup="dispdata()" style="margin-top:80px; width:50%; margin-left:25%; height:30px; border-radius:15px;  background-color: cyan;  border:0px;  outline:0;" placeholder="Search here...">

<p id='getnames' style="margin-left :50px; "></p>
</div>
<div  id="div2" style="width:80%; margin-left:10%; position:center; ; display:none">
<br><br><br><br>
<p id="details" style="margin-left:25px; "> </p>
<input type=button id='btn1' value='Close' onclick='hide()' 
</div>

<script>

url='https://script.google.com/macros/s/AKfycbzI9SDFOzYLYKRKJTlse0XpsEiF8XfbyxwUUH22evlGkEPDIt2V/exec'
async function getMyData (){
response= await fetch(url)
data= await response.json()
tempData=data["user"]
dispdata()
}

getMyData()

function dispdata(){
let  filter = document.getElementById("myInput").value.toLowerCase()
if (filter.length<=4){document.getElementById("getnames").innerHTML="" }
if (filter.length>=3){
toTable = tempData.filter(a => a.name.toLowerCase().includes(filter.toLowerCase()))
.sort((a, b) => {
    let fa = a.name.toLowerCase(), fb = b.name.toLowerCase();
    if (fa < fb) {return -1;}
    if (fa > fb) {return  1;}
    return 0;
}).map (a => [a.id, a.name]);
tablebody=""
toTable.forEach(function(a){tablebody+= "<span onClick='nameclick(this.id)' id="+ a[0] + ">" +a[1].toUpperCase() + "</span><br>"})
document.getElementById("getnames").innerHTML=tablebody
}
}

function nameclick(membershipNo){
document.getElementById("div2").style.display = "block";
document.getElementById("div1").style.display = "none";
document.getElementById("myInput").value=""
membno= membershipNo*1-1 ; 
membData= tempData.filter(a => a.id ===membershipNo*1)
toDisplay = "Name:  " + membData[0].name + "<br>"
toDisplay += "Membership No:" + membData[0].id + "<br>"
toDisplay += "Address: <br>" + membData[0].add1 + "<br>"
if(membData[0].add2.length>0){toDisplay += membData[0].add2+"<br>" }
if(membData[0].add3.length>0){toDisplay += membData[0].add3+"<br>" }
if(membData[0].place.length>0){toDisplay += membData[0].place+ "  " +membData[0].pincode + "<br>"   }
if(membData[0].district.length>0){toDisplay += membData[0].district+" District <br>" }
toDisplay += "Phones: <br>"
if(membData[0].fixed.length>0){toDisplay += membData[0].fixed + " / "}
if(membData[0].mobile1>0){toDisplay += membData[0].mobile1 }
if(membData[0].mobile2>0){toDisplay +=   " / "+ membData[0].mobile2}
toDisplay += "<br>SR No: " + membData[0].srno + "<br>"
toDisplay += "Pension Br: " +membData[0].pensionbr + "<br>"
toDisplay += "Pension Acc: " +membData[0].sbac.toString().replace(/\b[\dX][-. \dX]+(\d{4})\b/g, '******** $1') + "<br>"
toDisplay += "<input type=button id='btn1' value='close' onclick='hide()' "
document.getElementById("details").innerHTML=toDisplay
}
function hide(){
document.getElementById("div2").style.display = "none";
document.getElementById("div1").style.display = "block";
document.getElementById("getnames").innerHTML="" 
}

</script>


</body>
</html>
